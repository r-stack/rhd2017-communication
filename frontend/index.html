<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>キャッチーなタイトル</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/semantic-ui/2.2.10/semantic.min.css">

    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/semantic-ui/2.2.10/semantic.min.js"></script>
    <script src="js/echarts.min.js"></script>
    <script src="data/pie.js"></script>


    <style>
        #header {
            height: 55px;
            margin-bottom: 40px;
        }

        #main {
            max-width: 850px !important;
        }

        #map-area {
            position: relative;
        }

        #mine-position {
            transition: transform 2s linear;
            transform: translate(50px, -300px);
        }

        .pie-mine {
            width: 100%;
            height: 300px;
        }

        .pie-friends {
            width: 100%;
            height: 250px;
        }
    </style>

</head>

<body>
    <div class="ui inverted teal menu" id="header"></div>
    <div class="ui container" id="main">
        <div class="ui one column grid">
            <div class="column">
                <div class="ui segment">
                    <div id="map-area">
                        <img class="ui centered huge image" src="img/map.png">
                        <div id="mine-position"><img src="img/location-pin.png"></div>
                    </div>
                </div>
            </div>
            <div class="column">
                <div class="ui segment">
                    <div class="ui two column grid">
                        <div class="column">
                            <div class="ui segment">
                                <h4 class="ui header">最近の休み時間</h4>
                                <div class="pie-mine" id="pie-mine"></div>
                            </div>
                        </div>
                        <div class="column">
                            <div class="ui segment">
                                最近は休み時間を図書室で過ごすのが流行りのようです。
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="column">
                <div class="ui segment">
                    <h4 class="ui header">最近一緒のふれんず TOP3</h4>
                    <div class="ui three column grid">
                        <div class="column">
                            1.
                            <div class="ui segment">
                                <div class="pie-friends" id="pie-friends-1"></div>
                            </div>
                        </div>
                        <div class="column">
                            2.
                            <div class="ui segment">
                                <div class="pie-friends" id="pie-friends-2"></div>
                            </div>
                        </div>
                        <div class="column">
                            3.
                            <div class="ui segment">
                                <div class="pie-friends" id="pie-friends-3"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        const pieMine = echarts.init(document.getElementById('pie-mine'));
        pieMine.setOption(optionMine);
        const pieFriends1 = echarts.init(document.getElementById('pie-friends-1'));
        pieFriends1.setOption(optionFriends1);
        const pieFriends2 = echarts.init(document.getElementById('pie-friends-2'));
        pieFriends2.setOption(optionFriends2);
        const pieFriends3 = echarts.init(document.getElementById('pie-friends-3'));
        pieFriends3.setOption(optionFriends3);

        // リサイズした際にはアニメ無しで位置を保つ
        window.onresize = function () {
            pieMine.resize();
            pieFriends1.resize();
            pieFriends2.resize();
            pieFriends3.resize();

            const mapWidth = $('#map-area').width();
            const mapHeight = $('#map-area').height();
            x = mapWidth * 0.5;
            y = mapHeight * 0.5;
            
            $('#mine-position').css('transition', 'transform 0s linear');
            $('#mine-position').css('transform', 'translate(' + x + 'px, ' + -1 * y + 'px)');
        };

        var x = 50;
        
        // ５秒に一回ステータスを確認してポジションに移動
        setInterval(
            () => {
                $('#mine-position').css('transition', 'transform 2s linear');
                const mapWidth = $('#map-area').width();
                const mapHeight = $('#map-area').height();
                x = mapWidth * 0.5;
                x += 10;
                y = mapHeight * 0.5;
                $('#mine-position').css('transform', 'translate(' + x + 'px, ' + -1 * y + 'px)');
            },
            5000
        )
    </script>
</body>

</html>